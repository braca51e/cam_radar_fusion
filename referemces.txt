References for this code
https://gist.github.com/tdenewiler/e2172f628e49ab633ef2786207793336